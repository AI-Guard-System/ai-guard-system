var le=Object.defineProperty;var Xe=(l,a,r)=>a in l?le(l,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[a]=r;var Ye=(l,a)=>()=>(l&&(a=l(l=0)),a);var Qe=(l,a)=>{for(var r in a)le(l,r,{get:a[r],enumerable:!0})};var ce=(l,a,r)=>Xe(l,typeof a!="symbol"?a+"":a,r);var Ae={};Qe(Ae,{default:()=>rt});async function tt(l={}){var a,r=l,s=!!globalThis.window,o=!!globalThis.WorkerGlobalScope,i=globalThis.process?.versions?.node&&globalThis.process?.type!="renderer",A=[],c="./this.program",v=import.meta.url,w="",b,p;if(s||o){try{w=new URL(".",v).href}catch{}o&&(p=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),b=async e=>{var t=await fetch(e,{credentials:"same-origin"});if(t.ok)return t.arrayBuffer();throw new Error(t.status+" : "+t.url)}}var y=console.log.bind(console),E=console.error.bind(console),T,R=!1;function P(e){for(var t=0,n=e.length,f=new Uint8Array(n),d;t<n;++t)d=e.charCodeAt(t),f[t]=~d>>8&d;return f}var S,I,m,_,U,j,W,H,G,de,he,ye,L=!1;function ve(){var e=ie.buffer;m=new Int8Array(e),U=new Int16Array(e),_=new Uint8Array(e),j=new Uint16Array(e),W=new Int32Array(e),H=new Uint32Array(e),G=new Float32Array(e),de=new Float64Array(e),he=new BigInt64Array(e),ye=new BigUint64Array(e)}function we(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Ne(r.preRun.shift());K(Y)}function Re(){L=!0,O.b()}function _e(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)xe(r.postRun.shift());K(X)}function be(e){r.onAbort?.(e),e="Aborted("+e+")",E(e),R=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw I?.(t),t}var V;function Ee(){return P('\0asm\0\0\0`\x7F\x7F`\0\x7F`\x7F\0`\0\0\0\0\x07\xA2\x80\x80	\x7FA\x90\x90\x84\v\x07a\0b\0c\0d\0e\0f\0\0\f\n\xC1\0#\0\v\0#\0 \0kApq"\0$\0 \0\v\0 \0$\0\v\x9E\b\x7FA\x7F!A\x80\bA\x7F6\0@\x7F@@ \0"\x07AqE\r\0A\0 \0-\0\0E\r@ \0Aj"\0AqE\r \0-\0\0\r\0\v\f\v@ \0"Aj!\0A\x80\x82\x84\b (\0"\bk \brA\x80\x81\x82\x84xqA\x80\x81\x82\x84xF\r\0\v@ "\0Aj! \0-\0\0\r\0\v\v \0 \x07k\v"A\0L\r\0\x7F@A\xFF\xFF\xFF\0 A\xFF\xFF\xFF\0F\r   \x07j-\0\0"\0:\0\x90 Aq!A\0!@ \r\0 \0A\xDC\0F@A!\f\v \0A"F@ As!\f\v Aq@A!\f\v@@@ \0A\xDB\0G@ \0A\xFB\0G\r A\xFE\x07J\rA\0!A\x80\b Aj"\x006\0 A\x91\bjA\xFD\0:\0\0 \0!\f\v A\xFE\x07J\rA\0!A\x80\b Aj"\x006\0 A\x91\bjA\xDD\0:\0\0 \0!\f\vA\0! \0A\xDFqA\xDD\0G\r A\0H\r -\0\x90\b \0G\rA\x80\b Ak"6\0\f\vA\0!\v\v Aj" G\r\0\v \v! Aq@ A":\0\x90 Aj!\vA\0! A\0H\r\0@ AqAF@ !\f\v AjAq!\0 !@ A\x90j -\0\x90\b:\0\0 Aj! Ak! Aj" \0G\r\0\v\v AO@@ A\x90j A\x90\bj-\0\0:\0\0 A\x91j A\x8F\bj-\0\0:\0\0 A\x92j A\x8E\bj-\0\0:\0\0 A\x93j A\x8D\bj-\0\0:\0\0 Aj! AG Ak!\r\0\v\vA\x80\bA\x7F6\0\v A\x90jA\0:\0\0A\x90\v\0\v\v\v\0A\x80\b\v\xFF\xFF\xFF\xFF')}function it(e){return e}async function Se(e){return e}async function ke(e,t){try{var n=await Se(e),f=await WebAssembly.instantiate(n,t);return f}catch(d){E(`failed to asynchronously prepare wasm: ${d}`),be(d)}}async function Pe(e,t,n){return ke(t,n)}function Te(){var e={a:Le};return e}async function je(){function e(h,u){return O=h.exports,Ze(O),ve(),O}function t(h){return e(h.instance)}var n=Te();if(r.instantiateWasm)return new Promise((h,u)=>{r.instantiateWasm(n,(g,N)=>{h(e(g,N))})});V??(V=Ee());var f=await Pe(T,V,n),d=t(f);return d}class ot{constructor(t){ce(this,"name","ExitStatus");this.message=`Program terminated with exit(${t})`,this.status=t}}for(var K=e=>{for(;e.length>0;)e.shift()(r)},X=[],xe=e=>X.push(e),Y=[],Ne=e=>Y.push(e),Be=!0,Ue=e=>ne(e),Me=()=>se(),Q=e=>{var t=r["_"+e];return t},Ce=(e,t)=>{m.set(e,t)},Ie=e=>{for(var t=0,n=0;n<e.length;++n){var f=e.charCodeAt(n);f<=127?t++:f<=2047?t+=2:f>=55296&&f<=57343?(t+=4,++n):t+=3}return t},We=(e,t,n,f)=>{if(!(f>0))return 0;for(var d=n,h=n+f-1,u=0;u<e.length;++u){var g=e.codePointAt(u);if(g<=127){if(n>=h)break;t[n++]=g}else if(g<=2047){if(n+1>=h)break;t[n++]=192|g>>6,t[n++]=128|g&63}else if(g<=65535){if(n+2>=h)break;t[n++]=224|g>>12,t[n++]=128|g>>6&63,t[n++]=128|g&63}else{if(n+3>=h)break;t[n++]=240|g>>18,t[n++]=128|g>>12&63,t[n++]=128|g>>6&63,t[n++]=128|g&63,u++}}return t[n]=0,n-d},Fe=(e,t,n)=>We(e,_,t,n),ee=e=>ae(e),Oe=e=>{var t=Ie(e)+1,n=ee(t);return Fe(e,n,t),n},te=globalThis.TextDecoder&&new TextDecoder,De=(e,t,n,f)=>{var d=t+n;if(f)return d;for(;e[t]&&!(t>=d);)++t;return t},ze=(e,t=0,n,f)=>{var d=De(e,t,n,f);if(d-t>16&&e.buffer&&te)return te.decode(e.subarray(t,d));for(var h="";t<d;){var u=e[t++];if(!(u&128)){h+=String.fromCharCode(u);continue}var g=e[t++]&63;if((u&224)==192){h+=String.fromCharCode((u&31)<<6|g);continue}var N=e[t++]&63;if((u&240)==224?u=(u&15)<<12|g<<6|N:u=(u&7)<<18|g<<12|N<<6|e[t++]&63,u<65536)h+=String.fromCharCode(u);else{var M=u-65536;h+=String.fromCharCode(55296|M>>10,56320|M&1023)}}return h},He=(e,t,n)=>e?ze(_,e,t,n):"",re=(e,t,n,f,d)=>{var h={string:k=>{var D=0;return k!=null&&k!==0&&(D=Oe(k)),D},array:k=>{var D=ee(k.length);return Ce(k,D),D}};function u(k){return t==="string"?He(k):t==="boolean"?!!k:k}var g=Q(e),N=[],M=0;if(f)for(var C=0;C<f.length;C++){var oe=h[n[C]];oe?(M===0&&(M=Me()),N[C]=oe(f[C])):N[C]=f[C]}var $=g(...N);function Ke(k){return M!==0&&Ue(M),u(k)}return $=Ke($),$},Je=(e,t,n,f)=>{var d=!n||n.every(u=>u==="number"||u==="boolean"),h=t!=="string";return h&&d&&!f?Q(e):(...u)=>re(e,t,n,u,f)},F=new Uint8Array(123),x=25;x>=0;--x)F[48+x]=52+x,F[65+x]=x,F[97+x]=26+x;if(F[43]=62,F[47]=63,r.noExitRuntime&&(Be=r.noExitRuntime),r.print&&(y=r.print),r.printErr&&(E=r.printErr),r.wasmBinary&&(T=r.wasmBinary),r.arguments&&(A=r.arguments),r.thisProgram&&(c=r.thisProgram),r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.shift()();r.ccall=re,r.cwrap=Je;var qe,ne,ae,se,Ge,$e,ie;function Ze(e){qe=r._repair_json=e.c,ne=e.d,ae=e.e,se=e.f,Ge=ie=e.a,$e=e.__indirect_function_table}var Le={};function Ve(){we();function e(){r.calledRun=!0,!R&&(Re(),S?.(r),r.onRuntimeInitialized?.(),_e())}r.setStatus?(r.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>r.setStatus(""),1),e()},1)):e()}var O;return O=await je(),Ve(),L?a=r:a=new Promise((e,t)=>{S=e,I=t}),a}var rt,pe=Ye(()=>{rt=tt});var et={CREDIT_CARD:/\b(?:\d{4}[ -]?){3}\d{4}\b/,EMAIL:/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}\b/,API_KEY:/\b(sk-[a-zA-Z0-9]{20,}|ghp_[a-zA-Z0-9]{36}|gho_[a-zA-Z0-9]{36})\b/,SSN:/\b\d{3}-\d{2}-\d{4}\b/,IPV4:/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/,AWS_KEY:/\b(AKIA[0-9A-Z]{16})\b/,JWT:/\beyJ[a-zA-Z0-9_-]*\.eyJ[a-zA-Z0-9_-]*\.[a-zA-Z0-9_-]*\b/};function fe(l,a={},r=!1,s=[],o=[]){let i={};Array.isArray(a)?i={rules:a,redact:r,allow:s,customRules:o,mode:"block"}:i={rules:[],redact:!1,allow:[],customRules:[],mode:"block",...a};let{rules:A=[],redact:c=!1,allow:v=[],customRules:w=[],mode:b="block"}=i,p=l,y=[],E=!0,T={...et};for(let m of w)m.name&&m.pattern&&(T[m.name]=m.pattern);let R=A.length>0?A:Object.keys(T),P=v.map(m=>typeof m=="string"?new RegExp(m):m);for(let m of R){let _=T[m];if(!_)continue;let U=new RegExp(_.source,"g"),j=l.match(U);if(j&&j.length>0){let W=j.filter(H=>!P.some(G=>G.test(H)));W.length>0&&(E=!1,y.push({type:m,matches:W}))}}if(!E&&(c||b==="block"))for(let m of y)for(let _ of m.matches)p=p.replace(_,`[${m.type}_REDACTED]`);let S=E?"safe":"blocked";return!E&&b==="warn"&&(S="warning"),{safe:E||b==="warn"||b==="silent",status:S,findings:y,text:p}}function Z(l){if(!l)return"";let a=l.trim();return a=a.replace(/^```[a-zA-Z]*\s*/,""),a=a.replace(/\s*```$/,""),a}function J(l,a={}){if(!l)return"";let{last:r=!0}=a,s=l;s=s.replace(/<think>[\s\S]*?<\/think>/gi,""),s=s.replace(/<think>[\s\S]*$/gi,"");let o=/```(?:json|json5|javascript|js)?\s*([\s\S]*?)(?:```|$)/gi,i=[],A;for(;(A=o.exec(s))!==null;){let R=A[1].trim();R&&(R.startsWith("{")||R.startsWith("["))&&i.push(R)}if(i.length>0)return r?i[i.length-1]:i[0];let c=[],v=0,w=-1,b=!1,p=!1;for(let R=0;R<s.length;R++){let P=s[R];if(p){p=!1;continue}if(P==="\\"&&b){p=!0;continue}if(P==='"'&&!p){b=!b;continue}b||(P==="{"||P==="["?(v===0&&(w=R),v++):(P==="}"||P==="]")&&(v--,v===0&&w!==-1&&(c.push(s.slice(w,R+1)),w=-1)))}if(w!==-1&&v>0&&c.push(s.slice(w)),c.length>0)return r?c[c.length-1]:c[0];let y=s.indexOf("{"),E=s.indexOf("[");if(y===-1&&E===-1)return s.trim();let T=y===-1?E:E===-1?y:Math.min(y,E);return s.slice(T).trim()}function ue(l,a={}){let{extract:r=!1}=a,s=r?J(l):Z(l);if(!s||!s.trim())return{fixed:"{}",data:{},isPartial:!1,patches:[]};let o=s.trim(),i=[],A=!1,c=[],v=!1,w=!1;for(let p=0;p<o.length;p++){let y=o[p];if(w){w=!1;continue}if(y==="\\"&&v){w=!0;continue}if(y==='"'&&!w){v=!v,v?c.push('"'):c.length>0&&c[c.length-1]==='"'&&c.pop();continue}v||(y==="{"?c.push("{"):y==="["?c.push("["):y==="}"?c.length>0&&c[c.length-1]==="{"&&c.pop():y==="]"&&c.length>0&&c[c.length-1]==="["&&c.pop())}if(v&&(i.push({type:"unclosed_string",index:o.length}),o+='"',A=!0,c.length>0&&c[c.length-1]==='"'&&c.pop()),/,\s*$/.test(o)){let p=o.match(/,\s*$/);i.push({type:"trailing_comma",index:p.index}),o=o.replace(/,\s*$/,""),A=!0}for(;c.length>0;){let p=c.pop();p==="{"?(i.push({type:"missing_brace",index:o.length}),o+="}",A=!0):p==="["&&(i.push({type:"missing_brace",index:o.length}),o+="]",A=!0)}let b=null;try{b=JSON.parse(o)}catch{}return{fixed:o,data:b,isPartial:A,patches:i}}var q=null,ge=null,me=!0;async function nt(){if(!q){if(!me)throw new Error("Wasm Kernel is disabled in this build.");try{let l=await Promise.resolve().then(()=>(pe(),Ae));q=await(l.default||l)(),ge=q.cwrap("repair_json","string",["string"])}catch(l){throw console.error("Failed to load Wasm kernel:",l),l}}}var B=new Map,z=new Map;async function at(l){let{name:a,url:r,module:s}=l;if(B.has(a))return{success:!0,name:a,cached:!0};if(z.has(a))return await z.get(a),{success:!0,name:a,cached:!0};let o=(async()=>{try{let i;if(s)i=s;else if(r)i=await import(r);else throw new Error("Plugin requires either url or module");return typeof i.init=="function"&&await i.init(),B.set(a,i),i}catch(i){throw z.delete(a),i}})();return z.set(a,o),await o,{success:!0,name:a}}async function st(l,a=null){let r=[],s=a?a.filter(o=>B.has(o)):Array.from(B.keys());for(let o of s){let i=B.get(o);if(i&&typeof i.check=="function")try{let A=await i.check(l);if(r.push({name:o,...A}),!A.safe)return{safe:!1,blockedBy:o,reason:A.reason||"Plugin blocked",score:A.score,results:r}}catch(A){r.push({name:o,error:A.message})}}return{safe:!0,results:r}}self.onmessage=async l=>{let{id:a,type:r,payload:s,options:o}=l.data;try{let i;switch(r){case"LOAD_PLUGIN":i=await at(s);break;case"UNLOAD_PLUGIN":let A=typeof s=="string"?s:s.name;B.delete(A),z.delete(A),i={success:!0,name:A};break;case"LIST_PLUGINS":i={plugins:Array.from(B.keys())};break;case"SCAN_TEXT":let c=typeof s=="string"?s:s?.text,v=o?.rules||s?.enabledRules||[],w=o?.redact??s?.redact??!1,b=o?.allow||s?.allow||[],p=o?.customRules||s?.customRules||[],y=o?.runPlugins??s?.runPlugins??!0,E=o?.plugins||s?.plugins||null;if(i=fe(c,v,w,b,p),i.safe&&y&&B.size>0){let S=await st(c,E);S.safe?i.pluginResults=S.results:i={...i,safe:!1,blockedBy:S.blockedBy,reason:S.reason,score:S.score,pluginResults:S.results}}break;case"REPAIR_JSON":{let S=typeof s=="string"?s:s?.text,I=o?.extract??s?.extract??!1,m=o?.useWasm&&me,_;if(m){q||await nt();let W=I?J(S):Z(S);_={fixed:ge(W),data:null,isPartial:!1,patches:[]}}else _=ue(S,{extract:I});let U=_.data,j=!0;if(U===null&&_.fixed!=="null")try{U=JSON.parse(_.fixed)}catch{j=!1}i={fixedString:_.fixed,data:U,isValid:j,isPartial:_.isPartial,patches:_.patches,mode:m?"wasm":"js"}}break;case"EXTRACT_JSON":let T=typeof s=="string"?s:s?.text,R=o?.last??s?.last??!0;i={extracted:J(T,{last:R})};break;default:throw new Error(`Unknown message type: ${r}`)}self.postMessage({id:a,success:!0,payload:i})}catch(i){self.postMessage({id:a,success:!1,error:i.message})}};
